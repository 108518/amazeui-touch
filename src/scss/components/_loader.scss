// Amaze UI Mobile: Loading spinner
//
// @see https://github.com/rtheunissen/md-preloader
// =============================================================================

// Output
// -----------------------------------------------------------------------------
.#{$loader-prefix} {
  $easing: cubic-bezier(.8,.0,.4,.8);
  $speed: 1320ms;       // animation time for each loop
  $linecap: square;       // could be 'round', but the official one is square
  $loops: 5;            // number of points where the arc meets
  $arc: 0.72;         // fraction of the circumference that the arc grows to
  $perimeter: pi() * 67px;  // circumference of the raw svg inner cricle

  display: inline-block;
  @include square($loader-width);
  // measure to prevent inline block spacing from affecting the outer rotation
  font-size: 0;
  animation: loader-outer $speed * $loops linear infinite;

  svg {
    width: 100%;
    height: 100%;
    animation: loader-inner $speed linear infinite;

    circle {
      fill: none;
      stroke: $loader-color;
      stroke-linecap: $linecap;
      animation: loader-arc $speed $easing infinite;
    }
  }

  @keyframes loader-outer {
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes loader-inner {
    0% {
      transform: rotate(-360deg * (1 - $arc));
    }
    100% {
      transform: rotate(0);
    }
  }

  @keyframes loader-arc {
    0% {
      stroke-dasharray: 1 $perimeter;
      stroke-dashoffset: 0;
    }
    40% {
      stroke-dasharray: $arc * $perimeter, $perimeter;
      stroke-dashoffset: 0;
    }
    100% {
      stroke-dasharray: 1 $perimeter;
      stroke-dashoffset: -$arc * $perimeter;
    }
  }
}
